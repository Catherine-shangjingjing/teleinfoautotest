# 上传excel文件
config:
    name: 上传excel文件
    base_url: ${ENV(HOST)}
    verify: false
#    variables:
#        account: ${ENV(adminaccount)}
#        password: ${ENV(adminpassword)}
##        session: ${get_session($account, $password)}
#        fileName: ${ENV(excelFileName)}
teststeps:
-   name: 上传excel文件
    request:
        cookies:
            SESSION: $entSession
        upload:
            file: data/$fileName
        headers:
            Accept: application/json, text/plain, */*
            Accept-Encoding: gzip, deflate
            Accept-Language: zh-CN,zh;q=0.9
            Connection: keep-alive
            Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryuuYTKqAamjwMPiuD
            User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36
                (KHTML, like Gecko) Chrome/105.0.0.0 Safari/537.36
        method: POST
        url: /api/snms/identityv2/data/uploadExcel
    validate:
    -   eq:
        - status_code
        - 200
    -   eq:
        - headers.Content-Type
        - application/json
    -   eq:
        - body.message
        - success
    -   eq:
        - body.status
        - 1
    -   eq:
        - body.data
        - true
